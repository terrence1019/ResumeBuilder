
@using RésuméBuilder.Models

@{
    ViewBag.Title = "EditJobsPageView";
    Layout = "~/Views/Shared/_Layout.cshtml";

    //This value correlates to the ApplicantID between the Applicant and Skills Models
    //var id = ViewBag.TargetID;
    //Due to the nature of a Session variable, we have to convert it to an integer
    var id = Convert.ToInt32(Session["id"]);

    //Set up instance of Database Context
    MyDbContext dbContext = new MyDbContext();

}

<h2>EditJobsPageView</h2>

<body>

    <h2>Edit Your Job Experience</h2>

    <h3>Edit Job Experience Details for Registration ID @id</h3>


    @{ 

        //Pull up Job records associated with ApplicantID
        //Pull up JobDetail records associated with ApplicantID
        //Store Applicant Job records in special list
        //Store Applicant JobDetail records in special list
        //Traverse Job list with JobDetail list as a sub-list. The key element is JobID



        var JobsTable = dbContext.jobDB;
        var JobDetailsTable = dbContext.jobdetailDB;

        List <Job> jobList = new List<Job>();
        List <JobDetail> jobdetailList = new List<JobDetail>();



        //Get all Job Records related to Applicant, and
        //then store them in Job list
        foreach (var job in JobsTable)
        {
            if(job.ApplicantID == id)
            {
                jobList.Add(job);
            }
        }


        //Get all Job Detail Records related to Applicant, and
        //then store them in Job list
        foreach (var jobdetail in JobDetailsTable)
        {
            if(jobdetail.ApplicantID == id)
            {
                jobdetailList.Add(jobdetail);
            }
        }



        foreach(var jobrecord in jobList)
        {
            var jobid1 = jobrecord.JobID;

                <table>
                    <tr>
                    <td>@jobid1</td>
                    </tr>
                    <tr>
                        <td>@jobrecord.CompanyName</td>
                    </tr>
                    <tr>
                        <td>@jobrecord.Position</td>
                    </tr>
                    <tr>
                        <td>@jobrecord.FromDate</td>
                    </tr>
                    <tr>
                        <td>@jobrecord.ToDate</td>
                    </tr>
                    <tr>
                        <td>
                            @foreach(var jobdetail in jobdetailList)
                            {
                                var jobid2 = jobdetail.JobID;

                                if(jobid2.Equals(jobid1))
                    {
                                    <p>@jobdetail.JobFunction</p>
                    }
                            }
                        </td>
                    </tr>
                </table>
                <br />
            }




    }



</body>